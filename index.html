<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DCA</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
    <header>
        <h1>Connect to Form</h1>
    </header>

    <form name="google-sheet1">
        <div id="form_alerts"></div>
        <div class="col-lg-12 mb-3">
            <input type="text" name="name" placeholder="nome" id="InputFirstname" required class="shadow form-control form-control-1g">
        </div>

        <div class="col-1g-12 mb-3">
            <input type="email" placeholder="Email" name="email" id="inputEmail" required class="shadow form-control form-control-lg">
        </div>

        <div class="col-1g-12 mb-3">
            <textarea name="message" placeholder="conte aqui como podemos ajudar" required id="message" rows="8" class="shadow form-control form-control-lg">
            </textarea>
        </div>
        <div classe="text-center d-grid mt-1">
            <button type="submit" data-bs-toggle="modal" data-bs-target="#form-popup" class="btn btn-primary rounded-pill pt-3 pb-3">
            Enviar
            </button>
        </div>
    </form>


    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxN1ELMTagM7qmVVvxchC219p7suvaNDNY2lgDujUtxhyLXzGbKY9LbpOUbe-zDeU8e4Q/exec'
        
        const form = document.forms['google-sheet1']

        form.addEventListener('submit', e=>{
            e.preventDefault()
            fetch(scriptURL,{method: 'POST', body: new FormData(form)})
                .then(Response => $("#form_alerts").html("<div class='alert alert-sucess'>Mensagem enviada com sucesso</div>"))
                .catch(error => $("#form_alerts").html("<div class='alert alert-danger'>Erro ao enviar a mensagem</div>"))
        })

    </script>
    
</body>
</html>